<!DOCTYPE html>
<html lang="en" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expression Sharpener (Offline)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Plus Jakarta Sans', 'Inter', 'sans-serif'],
                    },
                },
            },
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap');
        
        body { transition: background-color 0.3s ease; }

        /* Highlight Styles - Sharp Badges */
        .hl-noun { background-color: #dbeafe; color: #1e40af; border-bottom: 2px solid #3b82f6; font-weight: 700; padding: 0 4px; border-radius: 4px; display: inline-block; line-height: 1.2; cursor: help; }
        .hl-passive { background-color: #fee2e2; color: #991b1b; border-bottom: 2px solid #ef4444; font-weight: 700; padding: 0 4px; border-radius: 4px; display: inline-block; line-height: 1.2; cursor: help; }
        .hl-basic { background-color: #dcfce7; color: #15803d; border-bottom: 2px solid #22c55e; font-weight: 700; padding: 0 4px; border-radius: 4px; display: inline-block; line-height: 1.2; cursor: help; }
        .hl-repeat { background-color: #f3e8ff; color: #6b21a8; border-bottom: 2px solid #a855f7; font-weight: 700; padding: 0 4px; border-radius: 4px; display: inline-block; line-height: 1.2; cursor: help; }
        .hl-stop { background-color: #fef9c3; color: #854d0e; border-bottom: 2px solid #eab308; font-weight: 700; padding: 0 4px; border-radius: 4px; display: inline-block; line-height: 1.2; cursor: help; }

        /* Dark Mode */
        .dark .hl-noun { background-color: rgba(30, 58, 138, 0.9); color: #bfdbfe; border-color: #60a5fa; }
        .dark .hl-passive { background-color: rgba(127, 29, 29, 0.9); color: #fecaca; border-color: #f87171; }
        .dark .hl-basic { background-color: rgba(6, 78, 59, 0.9); color: #bbf7d0; border-color: #4ade80; }
        .dark .hl-repeat { background-color: rgba(88, 28, 135, 0.9); color: #e9d5ff; border-color: #c084fc; }
        .dark .hl-stop { background-color: rgba(113, 63, 18, 0.9); color: #fef08a; border-color: #facc15; }

        aside { height: 100vh; position: sticky; top: 0; }
        @media (max-width: 768px) { aside { height: auto; position: relative; } }
    </style>
</head>
<body class="bg-white text-slate-900 dark:bg-slate-950 dark:text-slate-100 min-h-screen">

    <div class="flex flex-col md:flex-row min-h-screen">
        
        <!-- SIDEBAR -->
        <aside class="w-full md:w-80 bg-slate-50 dark:bg-slate-900 border-r border-slate-200 dark:border-slate-800 p-6 flex flex-col gap-8 shadow-sm z-30">
            <div>
                <h1 class="text-2xl font-black text-blue-600 flex items-center gap-2">
                    <i data-lucide="pencil-line"></i> Sharpener
                </h1>
                <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-1">Offline Database Mode</p>
            </div>

            <div class="space-y-6">
                <!-- Mode Switch -->
                <div>
                    <label class="text-[10px] font-black uppercase text-slate-400 tracking-tighter mb-2 block">Writing Mode</label>
                    <div class="flex p-1 bg-white dark:bg-slate-800 rounded-xl gap-1 border border-slate-200 dark:border-slate-700">
                        <button id="modeNarrative" class="mode-btn flex-1 py-2 text-xs font-bold rounded-lg bg-blue-600 text-white shadow-md transition-all">Narrative</button>
                        <button id="modeAnalytical" class="mode-btn flex-1 py-2 text-xs font-bold rounded-lg text-slate-500 hover:text-blue-600 dark:hover:text-blue-400 transition-all">Analytical</button>
                    </div>
                </div>

                <!-- Actions -->
                <div class="space-y-3 pt-2 border-t border-slate-200 dark:border-slate-700">
                    <button id="btnGenerate" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-4 rounded-xl font-bold flex items-center justify-center gap-2 transition-all shadow-lg shadow-blue-500/20 active:scale-95">
                        <i data-lucide="shuffle" class="w-5 h-5"></i> Get New Example
                    </button>
                    <button id="btnReveal" disabled class="w-full py-4 rounded-xl font-bold flex items-center justify-center gap-2 transition-all border-2 border-emerald-500/20 bg-emerald-50 dark:bg-emerald-900/10 text-emerald-700 dark:text-emerald-400 opacity-30 cursor-not-allowed">
                        <i data-lucide="eye" class="w-5 h-5"></i> Reveal Models
                    </button>
                    <button id="btnReset" class="w-full py-3 text-slate-400 hover:text-red-500 font-bold flex items-center justify-center gap-2 transition-colors">
                        <i data-lucide="rotate-ccw" class="w-4 h-4"></i> Reset
                    </button>
                </div>
            </div>

            <!-- Legend -->
            <div class="mt-auto border-t border-slate-200 dark:border-slate-800 pt-6">
                <h3 class="text-[10px] font-black uppercase text-slate-400 mb-4 tracking-widest text-center">Highlight Key</h3>
                <div class="grid grid-cols-1 gap-3 text-xs font-bold px-2">
                    <div class="flex items-center gap-3 text-slate-600 dark:text-slate-400"><div class="w-4 h-4 rounded bg-blue-500 shadow-sm"></div> Noun Start</div>
                    <div class="flex items-center gap-3 text-slate-600 dark:text-slate-400"><div class="w-4 h-4 rounded bg-red-500 shadow-sm"></div> Passive Voice</div>
                    <div class="flex items-center gap-3 text-slate-600 dark:text-slate-400"><div class="w-4 h-4 rounded bg-green-500 shadow-sm"></div> Basic Verb</div>
                    <div class="flex items-center gap-3 text-slate-600 dark:text-slate-400"><div class="w-4 h-4 rounded bg-purple-500 shadow-sm"></div> Repetition</div>
                    <div class="flex items-center gap-3 text-slate-600 dark:text-slate-400"><div class="w-4 h-4 rounded bg-yellow-500 shadow-sm"></div> Stop Words</div>
                </div>
                
                <button id="themeToggle" class="w-full mt-8 py-3 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 flex items-center justify-center gap-2 text-xs font-bold shadow-sm transition-all hover:border-blue-400">
                    <i data-lucide="moon" id="themeIcon"></i> <span id="themeLabel">Dark Mode</span>
                </button>
            </div>
        </aside>

        <!-- MAIN WORKSPACE -->
        <main class="flex-1 p-6 md:p-12 space-y-10 overflow-y-auto bg-white dark:bg-slate-950">
            
            <!-- Junior Card -->
            <section class="bg-white dark:bg-slate-900 rounded-3xl border-2 border-slate-100 dark:border-slate-800 shadow-xl shadow-slate-100 dark:shadow-none overflow-hidden transition-all">
                <div class="px-6 py-4 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-slate-50 dark:bg-slate-900/30">
                    <span class="text-[10px] font-black uppercase tracking-widest text-blue-500 flex items-center gap-2">
                        <i data-lucide="graduation-cap" class="w-4 h-4"></i> Year 5 Junior Draft
                    </span>
                    <button class="copy-btn text-slate-400 hover:text-blue-500 transition-colors" data-target="jrContent"><i data-lucide="copy" class="w-4 h-4"></i></button>
                </div>
                <div id="jrContent" class="p-10 md:p-14 min-h-[200px]">
                    <div class="flex flex-col items-center justify-center py-10 opacity-20 grayscale text-slate-900 dark:text-white">
                        <i data-lucide="book-open" class="w-12 h-12 mb-4"></i>
                        <p class="font-bold tracking-tight text-slate-900 dark:text-white">Ready to start.</p>
                    </div>
                </div>
            </section>

            <!-- Senior Card -->
            <section class="bg-white dark:bg-slate-900 rounded-3xl border-2 border-slate-100 dark:border-slate-800 shadow-xl shadow-slate-100 dark:shadow-none overflow-hidden transition-all">
                <div class="px-6 py-4 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-slate-50 dark:bg-slate-900/30">
                    <span class="text-[10px] font-black uppercase tracking-widest text-purple-500 flex items-center gap-2">
                        <i data-lucide="book" class="w-4 h-4"></i> Year 10 Senior Draft
                    </span>
                    <button class="copy-btn text-slate-400 hover:text-purple-500 transition-colors" data-target="srContent"><i data-lucide="copy" class="w-4 h-4"></i></button>
                </div>
                <div id="srContent" class="p-10 md:p-14 min-h-[200px]">
                    <div class="flex flex-col items-center justify-center py-10 opacity-20 grayscale text-slate-900 dark:text-white">
                        <i data-lucide="book-open" class="w-12 h-12 mb-4"></i>
                        <p class="font-bold tracking-tight text-center">Ready to start.</p>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <script>
        // ==========================================
        // DATABASE OF EXAMPLES (Add more here!)
        // ==========================================
        const database = {
            Narrative: {
                Year5: [
                    {
                        flawed: "<N>The</N> sun <B>went</B> down. <N>It</N> <P>was covered</P> by clouds. <N>The</N> boy <B>ran</B> fast. <N>He</N> <P>was scared</P> by <S>basically</S> everything. <N>He</N> <B>saw</B> a house. <N>It</N> <B>got</B> dark. <N>The</N> house <P>was made</P> of wood.",
                        improved: "As twilight descended, ominous clouds swallowed the sun. Sprinting frantically, the boy felt fear clutching at his chest. Looming ahead, a wooden house emerged from the shadows, its silhouette darkening against the evening sky."
                    },
                    {
                        flawed: "<N>She</N> <B>got</B> a present. <N>It</N> <P>was wrapped</P> in red paper. <N>She</N> <B>was</B> happy. <N>Then</N> <S>so</S> <N>she</N> <B>went</B> to open it. <N>It</N> <B>had</B> a puppy inside. <N>The</N> puppy <B>was</B> cute.",
                        improved: "Clutching the crimson-wrapped gift, a surge of joy rushed through her veins. Eagerly tearing away the paper, she discovered a tiny, adorable puppy nestled within the box."
                    },
                    {
                        flawed: "<N>The</N> treasure <P>was found</P> by pirates. <N>They</N> <B>were</B> excited. <N>It</N> <B>had</B> gold inside. <N>The</N> gold <P>was shiny</P>. <N>Then</N> <N>they</N> <B>got</B> in a fight. <N>The</N> fight <P>was stopped</P> by the captain.",
                        improved: "Discovering the treasure, the pirates erupted in excitement at the sight of the gleaming gold. However, greed quickly ignited a brawl, which was only quelled by the captain's roaring command."
                    },
                    {
                        flawed: "<N>He</N> <B>went</B> to the forest. <N>It</N> <P>was filled</P> with trees. <N>He</N> <B>saw</B> a bear. <N>The</N> bear <B>ran</B> at him. <N>He</N> <B>got</B> scared. <N>So</N> <N>he</N> <B>ran</B> away <S>very</S> fast.",
                        improved: "Venturing into the dense woodland, he froze upon spotting a massive bear. When the beast charged, panic seized him, forcing him to sprint away in a desperate bid for safety."
                    },
                    {
                        flawed: "<N>The</N> storm <B>got</B> loud. <N>It</N> <P>was heard</P> by everyone. <N>The</N> rain <B>came</B> down hard. <N>It</N> <P>was flooding</P> the street. <N>Then</N> the wind <B>blew</B> a tree over.",
                        improved: "Thunder roared, echoing through the neighborhood as the rain poured relentlessly. Floodwaters rapidly claimed the street, and a violent gust finally toppled an ancient tree."
                    }
                ],
                Year10: [
                    {
                        flawed: "<N>The</N> protagonist <P>is shown</P> to be isolated. <N>He</N> <B>goes</B> into the wild. <N>This</N> <P>is done</P> to escape society. <N>He</N> <B>sees</B> nature as pure. <N>It</N> <P>is represented</P> by the snow. <N>The</N> snow <S>really</S> shows his cold feelings.",
                        improved: "Seeking refuge from societal constraints, the protagonist retreats into the wilderness, viewing nature as a sanctuary of purity. The relentless snow mirrors his internal detachment, symbolizing a profound emotional frost."
                    },
                    {
                        flawed: "<N>The</N> conflict <P>is caused</P> by greed. <N>It</N> <B>makes</B> the characters fight. <N>They</N> <B>get</B> angry <S>very</S> quickly. <N>This</N> <P>is seen</P> in the climax. <N>The</N> climax <P>is where</P> everything goes wrong.",
                        improved: "Fueled by avarice, the conflict drives the characters toward inevitable violence. This destructive dynamic culminates in the climax, where their simmering anger erupts into catastrophic failure."
                    },
                    {
                        flawed: "<N>She</N> <B>has</B> a lot of power. <N>This</N> <P>is used</P> to control others. <N>The</N> others <P>are scared</P> of her. <N>They</N> <B>do</B> what she says. <N>This</N> <B>shows</B> that power corrupts.",
                        improved: "Wielding immense authority, she manipulates those around her through fear. Her dominance illustrates the corrupting influence of unchecked power, forcing subordinates into submission."
                    },
                    {
                        flawed: "<N>The</N> setting <B>is</B> dark. <N>It</N> <P>is described</P> as gloomy. <N>This</N> <B>makes</B> the mood sad. <N>The</N> sadness <P>is felt</P> by the reader. <N>It</N> <B>shows</B> there is no hope.",
                        improved: "Permeated by gloom, the dark setting establishes a pervasive melancholic mood. This atmosphere envelops the reader, effectively conveying a sense of utter hopelessness."
                    },
                    {
                        flawed: "<N>He</N> <B>makes</B> a bad choice. <N>This</N> <P>is caused</P> by his pride. <N>His</N> pride <B>is</B> his fatal flaw. <N>It</N> <B>leads</B> to his death. <N>The</N> death <P>is tragic</P>.",
                        improved: "Driven by hubris, his fatal decision seals his doom. This tragic downfall serves as a stark reminder of how unchecked pride inevitably leads to destruction."
                    }
                ]
            },
            Analytical: {
                Year5: [
                    {
                        flawed: "<N>The</N> author <B>uses</B> similes. <N>They</N> <P>are used</P> to describe the dog. <N>The</N> dog <B>is</B> like a wolf. <N>This</N> <B>shows</B> the dog is scary. <N>It</N> <B>makes</B> us feel scared too.",
                        improved: "Employing similes, the author compares the dog to a wolf to emphasise its ferocity. This technique effectively instills fear in the reader by highlighting the animal's predatory nature."
                    },
                    {
                        flawed: "<N>The</N> book <B>is</B> about friendship. <N>It</N> <B>shows</B> two friends. <N>They</N> <B>help</B> each other. <N>This</N> <P>is important</P> because <S>basically</S> friends are good. <N>The</N> ending <B>is</B> happy.",
                        improved: "Exploring the theme of friendship, the narrative demonstrates the value of mutual support. By depicting the characters' unwavering loyalty, the story underscores the importance of connection, leading to a heartwarming conclusion."
                    },
                    {
                        flawed: "<N>The</N> writer <B>says</B> plastic is bad. <N>It</N> <P>is dumped</P> in the ocean. <N>This</N> <B>hurts</B> the turtles. <N>We</N> <B>should</B> stop using it. <N>It</N> <B>is</B> a big problem.",
                        improved: "Highlighting the dangers of pollution, the writer argues that plastic waste devastates marine life, particularly turtles. Consequently, immediate action is required to eliminate this environmental crisis."
                    },
                    {
                        flawed: "<N>The</N> poem <B>has</B> rhyming words. <N>They</N> <B>make</B> it sound fun. <N>The</N> fun <P>is felt</P> when reading. <N>It</N> <B>is</B> about a cat. <N>The</N> cat <B>is</B> silly.",
                        improved: "Utilizing rhyme, the poem creates a playful rhythm that enhances the reader's enjoyment. This lighthearted structure perfectly complements the subject matter of the comical cat."
                    },
                    {
                        flawed: "<N>The</N> character <B>is</B> brave. <N>He</N> <B>saves</B> the day. <N>This</N> <B>shows</B> he is a hero. <N>Heroes</N> <P>are liked</P> by people. <N>He</N> <B>does</B> good things.",
                        improved: "Demonstrating immense courage, the character's heroic actions save the day. His selflessness defines him as a true hero, earning the admiration of the audience."
                    }
                ],
                Year10: [
                    {
                        flawed: "<N>The</N> author <B>uses</B> metaphors. <N>This</N> <P>is done</P> to show depression. <N>The</N> depression <P>is compared</P> to a black hole. <N>It</N> <B>sucks</B> everything in. <N>This</N> <B>makes</B> the reader understand the pain.",
                        improved: "Through the metaphor of a black hole, the author vividly depicts the consuming nature of depression. This comparison elucidates the protagonist's internal void, allowing the reader to grasp the gravity of their suffering."
                    },
                    {
                        flawed: "<N>The</N> play <B>shows</B> ambition. <N>It</N> <P>is shown</P> through Macbeth. <N>He</N> <B>kills</B> the king. <N>This</N> <B>is</B> bad. <N>It</N> <B>leads</B> to guilt. <N>The</N> guilt <B>makes</B> him crazy.",
                        improved: "Macbeth serves as a vessel for the exploration of unchecked ambition. His regicide triggers a psychological spiral, where overwhelming guilt eventually fractures his sanity."
                    },
                    {
                        flawed: "<N>The</N> text <B>critiques</B> society. <N>It</N> <B>says</B> money is evil. <N>This</N> <P>is seen</P> in the rich characters. <N>They</N> <B>are</B> mean. <N>The</N> poor people <P>are treated</P> badly.",
                        improved: "Critiquing societal materialism, the text posits that wealth breeds moral decay. This is exemplified by the cruelty of the affluent characters, contrasting sharply with the oppression faced by the impoverished."
                    },
                    {
                        flawed: "<N>The</N> imagery <B>is</B> violent. <N>It</N> <B>uses</B> words like blood. <N>This</N> <P>is used</P> to shock us. <N>The</N> shock <B>makes</B> us listen. <N>It</N> <B>shows</B> the horror of war.",
                        improved: "Deploying visceral, violent imagery, the text confronts the reader with the brutality of conflict. This shock tactic forces an acknowledgement of war's horrors, stripping away any romanticized notions of battle."
                    },
                    {
                        flawed: "<N>The</N> ending <B>is</B> ambiguous. <N>It</N> <B>doesn't</B> say what happened. <N>This</N> <B>makes</B> us think. <N>We</N> <B>have</B> to guess. <N>It</N> <B>is</B> a clever trick.",
                        improved: "Concluding with ambiguity, the narrative refuses to offer a definitive resolution. This open-endedness compels the reader to engage in interpretation, lingering on the thematic questions raised."
                    }
                ]
            }
        };

        // ==========================================
        // APP LOGIC
        // ==========================================
        
        let currentMode = "Narrative";
        let currentJr = null;
        let currentSr = null;

        lucide.createIcons();

        // Theme Toggle
        document.getElementById('themeToggle').addEventListener('click', () => {
            const isDark = document.documentElement.classList.toggle('dark');
            const themeIcon = document.getElementById('themeIcon');
            const themeLabel = document.getElementById('themeLabel');
            themeIcon.setAttribute('data-lucide', isDark ? 'sun' : 'moon');
            themeLabel.innerText = isDark ? 'Light Mode' : 'Dark Mode';
            lucide.createIcons();
        });

        // Mode Switching
        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.mode-btn').forEach(b => {
                    b.className = "mode-btn flex-1 py-2 text-xs font-bold rounded-lg text-slate-500 hover:text-blue-600 transition-all";
                });
                btn.className = "mode-btn flex-1 py-2 text-xs font-bold rounded-lg bg-blue-600 text-white shadow-md transition-all";
                currentMode = btn.innerText;
            });
        });

        // Tag Parser
        const formatText = (text) => {
            if (!text) return "";
            return text
                .replace(/<N>(.*?)<\/N>/g, '<span class="hl-noun">$1</span>')
                .replace(/<P>(.*?)<\/P>/g, '<span class="hl-passive">$1</span>')
                .replace(/<B>(.*?)<\/B>/g, '<span class="hl-basic">$1</span>')
                .replace(/<R>(.*?)<\/R>/g, '<span class="hl-repeat">$1</span>')
                .replace(/<S>(.*?)<\/S>/g, '<span class="hl-stop">$1</span>');
        };

        // Generation Logic (Random Selection)
        document.getElementById('btnGenerate').addEventListener('click', () => {
            const jrDiv = document.getElementById('jrContent');
            const srDiv = document.getElementById('srContent');
            
            // Get random items
            const jrList = database[currentMode].Year5;
            const srList = database[currentMode].Year10;
            
            currentJr = jrList[Math.floor(Math.random() * jrList.length)];
            currentSr = srList[Math.floor(Math.random() * srList.length)];

            jrDiv.innerHTML = `<div class="text-xl md:text-2xl leading-relaxed font-medium text-slate-800 dark:text-slate-100 animate-in fade-in duration-500 text-left">${formatText(currentJr.flawed)}</div>`;
            srDiv.innerHTML = `<div class="text-xl md:text-2xl leading-relaxed font-medium text-slate-800 dark:text-slate-100 animate-in fade-in duration-500 text-left">${formatText(currentSr.flawed)}</div>`;

            const revealBtn = document.getElementById('btnReveal');
            revealBtn.disabled = false;
            revealBtn.classList.remove('opacity-30', 'cursor-not-allowed');
        });

        // Reveal Logic
        document.getElementById('btnReveal').addEventListener('click', () => {
            const revealBtn = document.getElementById('btnReveal');
            revealBtn.disabled = true;

            const markup = (text) => `<div class="mt-12 pt-12 border-t-2 border-slate-100 dark:border-slate-800 animate-in fade-in slide-in-from-top-4 duration-700 text-left"><span class="inline-flex items-center gap-1.5 text-[10px] font-black uppercase text-emerald-500 bg-emerald-500/10 px-2.5 py-1.5 rounded-full mb-6 tracking-widest"><i data-lucide="check-circle" class="w-3 h-3"></i> Model Improvement</span><p class="text-xl leading-relaxed italic text-slate-500 dark:text-slate-400 font-medium">${text}</p></div>`;

            document.getElementById('jrContent').innerHTML += markup(currentJr.improved);
            document.getElementById('srContent').innerHTML += markup(currentSr.improved);
            lucide.createIcons();
        });

        document.getElementById('btnReset').addEventListener('click', () => location.reload());

        // Copy functionality
        document.querySelectorAll('.copy-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const targetId = btn.getAttribute('data-target');
                const targetEl = document.getElementById(targetId);
                // Extract only text, remove the Model Improvement part if present
                let text = targetEl.innerText;
                if(text.includes('Model Improvement')) {
                    text = text.split('Model Improvement')[0].trim();
                }
                
                const temp = document.createElement('textarea');
                temp.value = text;
                document.body.appendChild(temp);
                temp.select();
                document.execCommand('copy');
                document.body.removeChild(temp);
                
                const icon = btn.querySelector('i');
                icon.setAttribute('data-lucide', 'check');
                lucide.createIcons();
                setTimeout(() => { icon.setAttribute('data-lucide', 'copy'); lucide.createIcons(); }, 2000);
            });
        });
    </script>
</body>
</html>
